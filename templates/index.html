<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HAR NECT — Feed</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<header class="top-nav">
  <div class="logo"><span class="logo-blue">HAR</span><span class="logo-brown"> NECT</span></div>
  <div class="page-title">Home</div>
  {% if user %}
  <p>Welcome, {{ user }} | <a href="{{ url_for('logout') }}">Logout</a></p>
{% else %}
  <a href="{{ url_for('login') }}">Login</a>
  <a href="{{ url_for('signup') }}">Sign Up</a>
{% endif %}
  <div class="theme-toggle" id="themeToggle">🌙</div>
</header>

<main class="content">
  <div class="stories">
    <div class="story"><img src="{{ url_for('static', filename='uploads/user.png') }}" alt=""><p>You</p></div>
  </div>

  <div class="feed">
  {% for post in posts %}
    <div class="post">
      {% if post.filename.endswith('.mp4') or post.filename.endswith('.webm') or post.filename.endswith('.ogg') %}
        <!-- Video post -->
        <video controls width="100%" style="border-radius: 10px;">
          <source src="{{ url_for('static', filename='uploads/' + post.filename) }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      {% else %}
        <!-- Image post -->
        <img src="{{ url_for('static', filename='uploads/' + post.filename) }}" alt="Post">
      {% endif %}
    <!-- Post details -->
      <div class="post-info">
        <p><strong>@{{ post.user }}</strong></p>
        <p>{{ post.caption }}</p>
      </div>
      <div class="post-actions">
        <form action="{{ url_for('like_post', filename=post.filename) }}" method="POST" style="display:inline;">
    <button type="submit">❤️ {{ post.likes|length }} Likes</button>
  </form>

  <form action="{{ url_for('comment_post', filename=post.filename) }}" method="POST" style="display:inline;">
    <input type="text" name="comment" placeholder="Add comment..." required>
    <button type="submit">💬 Comment</button>
  </form>
        <button class="share-btn" onclick="sharePost('{{ url_for('static', filename='uploads/' + post.filename) }}')">🔄 Share</button>
      </div>

      <div class="comments">
    {% for c in post.comments %}
      <p><strong>@{{ c.user }}:</strong> {{ c.text }}</p>
    {% endfor %}
  </div>
    </div>
  {% endfor %}
</div>
</main>
<nav class="bottom-nav">
  <a href="{{ url_for('index') }}" class="active">🏠<span>Home</span></a>
  <a href="{{ url_for('explore') }}">🔍<span>Explore</span></a>
  <a href="{{ url_for('upload') }}" class="upload-btn">➕</a>
  <a href="{{ url_for('feedback') }}">💬<span>Feedback</span></a>
  <a href="{{ url_for('profile') }}">👤<span>Profile</span></a>
</nav>

<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
